import requests #, json, urllib, urllib2, hashlib, re, time, os, sys, argparse
from requests_ntlm import HttpNtlmAuth
from requests.packages.urllib3.util.retry import Retry
from requests.adapters import HTTPAdapter

user = 'kkbank\suttichai.int'
password = 'Anongsin$ook39'

http_proxy  = 'http://10.229.1.80:80'
proxy_dict = {'http': http_proxy, 'https': http_proxy}

retries = Retry(total=10,
                read=5,
                connect=6,
                #these options don't seem to help
                #backoff_factor=1,
                #method_whitelist=(['HEAD', 'TRACE', 'GET', 'POST', 'CONNECT', 'OPTIONS', 'DELETE']),
                #status_forcelist=[500, 502, 503, 504, 403, 407]
                )

session = requests.Session()
session.verify = False
session.mount('http://', HTTPAdapter(max_retries=retries))
session.mount('https://', HTTPAdapter(max_retries=retries))

session.proxies = proxy_dict
session.auth = HttpNtlmAuth(user, password)

# file/report
url = 'http://www.virustotal.com/vtapi/v2/file/report'
params = {'apikey': 'b000a95e07c82ec6bf90990bf789c43baa47668490ad1e0cd041a9cab886c97a', 'resource': '53c91bd78d3e4d4558dede33956be34a'}
response = session.get(url, params=params)
print(response.json())

'''
import os

os.chdir('D:\\')
os.system('dir *.dll *.exe /s /b >> "d:\\Users\\suttichai.int\\Desktop\\aum\\KKP\\Python WorkShop\\VirusTotal\\filename31_10_2018_Drive_D.txt"')
'''