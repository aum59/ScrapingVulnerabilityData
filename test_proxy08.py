import requests
import random
import time
import webbrowser
from selenium import webdriver


def main():
    user_agent_list = [
        # Chrome
        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36',
        'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36',
        'Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36',
        'Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36',
        'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36',
        'Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36',
        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36',
        'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36',
        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36',
        'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36',
        # Firefox
        'Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1)',
        'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko',
        'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)',
        'Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko',
        'Mozilla/5.0 (Windows NT 6.2; WOW64; Trident/7.0; rv:11.0) like Gecko',
        'Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko',
        'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0)',
        'Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko',
        'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)',
        'Mozilla/5.0 (Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0) like Gecko',
        'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)',
        'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)',
        'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)'
    ]

    # url = 'https://www.google.com/search?q=patch+tuesday+october+2019'

    # not work# url = 'https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1367'

    # url = 'https://www.exploit-db.com/exploits/47456'
    # url = 'https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010'
    url = 'https://www.rapid7.com/db/vulnerabilities/msft-cve-2019-1367'
    # url = 'https://nvd.nist.gov/vuln/detail/CVE-2018-0748'
    # url = 'https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8645'
    # url = 'https://www.google.com/search?q=site%3Amsrc-blog.microsoft.com+%2F+ms17-010'
    # url = 'https://www.thaicert.or.th/bulletins/'
    # url = 'https://access.redhat.com/security/cve/cve-2017-7895'
    # url = 'https://access.redhat.com/errata/RHSA-2017:2429'
    # url = 'https://cve.circl.lu/'
    # url = 'https://cve.circl.lu/cve/CVE-2017-18509'
    # url = 'https://www.tenable.com/plugins/nessus/102305'
    # url = 'https://www.tenable.com/cve/CVE-2017-7895'
    # url = 'https://usn.ubuntu.com/3161-1/'

    # Make the Session
    session = requests.Session()

    # # If Use in KKB Uncomment this
    # # Use px-proxy in command lind before run
    # # Set the proxies session
    # proxy_px = 'http://127.0.0.1:3128'
    # proxy_dict = {'http': proxy_px, 'https': proxy_px}
    # session.proxies = proxy_dict

    # Pick a random user agent
    user_agent = random.choice(user_agent_list)

    # Set the headers session
    session.headers = {'User-Agent': user_agent}

    # Make the request session
    response = session.get(url)
    print(user_agent)
    print(response.text)
    webbrowser.open_new_tab(url)  ## Open Web Url link

    # browser = webdriver.Firefox()
    # browser.get(url)
    # error #
    browser = webdriver.Chrome(executable_path='D:/aum/KKP/Python3 WorkShop/ScrapingVulnerabilityData/geckodriver-v0.25.0-win64/geckodriver.exe')
    # browser = webdriver.Chrome(executable_path='D:/aum/KKP/Python3 WorkShop/ScrapingVulnerabilityData/chromedriver_win32/chromedriver.exe')
    # browser.get('https://www.tenable.com/plugins/nessus/102305')
    browser.get(url)
    # time.sleep(5)  # Let the user actually see something!





if __name__ == '__main__':
    main()
